<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="SearchBilling.aspx.cs" Theme="Default" MasterPageFile ="~/Billing/Billing.Master" Inherits="Billing.Forms.SearchBilling" %>
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="ajax" %>
<asp:Content ID="headr" ContentPlaceHolderID="head" runat="server">
<script type="text/javascript">
    function ShowHide(id) {
        var el = document.getElementById('AdvSearch');
        var expcol = document.getElementById('imgA');
        if (el.style.display == 'none') {
            el.style.display ="";
            /*expcol.src = "Images/imgUblue.png" */
            expcol.src = "../../Billing/Images/imgUblue.PNG"
        }
        else {
            el.style.display = 'none';
            /* expcol.src = "Images/imgDblue.png" */
            expcol.src = "../../Billing/Images/imgDblue.PNG"
        }
    }    
</script>
<style type="text/css">
.popupHover
{
    background-color:#FAF8CC;
}
.LeftSide
{
  float:left;
clear:right;
height:0; 
 overflow:auto;
}
</style>
</asp:Content>
<asp:Content ID="Billing" ContentPlaceHolderID="main" runat="server">  
<asp:Panel ID="SearchTable" runat="server" >
 <div style="border:solid 1px #498AF3; width:570px;" >     
    <asp:TextBox ID="txtSearch" runat="server"  BorderStyle="None" BorderWidth="0px"  Height="18px" Width="500px"   ></asp:TextBox>        
    <asp:ImageButton ID="search" runat="server" CssClass="vAlign" ImageUrl="~/Billing/Images/imgSBlue1.bmp"   /><%-- OnClick="SearchBtnClick"--%>
    <a href="#" onclick="javascript:ShowHide(this);return false;" style="vertical-align:middle;"><input type="image"  
    src="../../Billing/Images/imgDblue.PNG" id="imgA" /></a>  
    <ajax:TextBoxWatermarkExtender ID="ajaxWaterMark" runat="server" TargetControlID="txtSearch"
     WatermarkText="Search..." ></ajax:TextBoxWatermarkExtender>
    
 </div>
<div id="AdvSearch" style="border:solid 1px #AACCEE; width:50%;display:none; margin-top:5px;">
<div style="border:solid 1px #498AF3; height:20px; background-color:#498AF3; color:White;">
<div style="margin-left:5px;margin-top:2px;">
<asp:Label ID="lblSearchControl"  runat="server" Text=" Advanced Search"  SkinID="" />
</div>
</div>

<div>
<table >
     <tr>
        <td>
            ID  </td>
        <td>            
            <asp:TextBox ID="txtID" runat="server" Width="150px" ></asp:TextBox>
        </td>
        <td>
            Created By  
        </td>
        <td>
            <asp:TextBox ID="txtCreatedBy" Width="150px" runat="server"></asp:TextBox>
            
        </td>
    </tr>
    <tr>
        <td>
            By Name (Company or Name)
        </td>
        <td>
            <asp:TextBox ID="txtCompany" Width="150px" runat="server"></asp:TextBox>
        </td>
        <td>
        </td>
        <td>
          <asp:Button runat="server" ID="ClearBtn" Text="Reset" OnClick="ClearBtnClick" />
        </td>
    </tr> 
</table>
 </div>
 </div>
 </asp:Panel>   
   <div>
    <br />
    <asp:GridView ID="BillingGridView" runat="server" AutoGenerateEditButton="false"  OnPageIndexChanging="BillingGridView_PageIndexChanging" 
    AutoGenerateDeleteButton="false" AutoGenerateColumns="false" SkinID="metro" OnRowCommand="BillingGridView_RowCommand"
    ShowFooter="true"   DataKeyNames="ID" DataSourceID="ODODS" OnRowCreated="BillingGridView_RowCreated"  >  
    
    <Columns>   
         
    <asp:TemplateField ItemStyle-Width="10px"> 
    <HeaderTemplate>
    <asp:ImageButton runat="server" ID="Copy" ImageUrl="~/Images/imgCopy.png" ToolTip="Create a copy from existing Bill" /> <%--OnClick="CopyBtnClick" --%>
    </HeaderTemplate>    
     <ItemTemplate>   
     <asp:CheckBox ID="cbSelect" runat="server"  />    
     </ItemTemplate> 
    </asp:TemplateField>  
    
     <asp:TemplateField>    
     <HeaderTemplate>
     <table style="width:100%;float:left;">
     <tr>    
     <td style="border:0px;width:25px;"></td>   
     <td style="border:0px;width:25px;"></td>       
     <td style="border:0px;width:25px;">ID</td>
     <td style="border:0px;width:400px;">Customer</td>
     <td style="border:0px;width:100px;">Item Total</td>
     <td style="border:0px;width:100px;">Bill Date</td>
     <td style="border:0px;width:100px;">Created By</td>
    <%-- <td style="border:0px;width:10%;">Requested For</td>--%>
     <td style="border:0px;width:100px;">Amended By</td>
     </tr>
     </table>
     </HeaderTemplate> 
     <ItemTemplate >   
     <asp:Panel ID="pnlOrder" runat="server">     
     <table class="TableClass" style="border:0px;width:100%;float:left;">     
     <tr style="border:0px;">
     <td style="border:0px;width:25px;"><asp:Image ID="imgCollapsible" ImageUrl="~/Images/iADD.bmp"  runat="server" /></td> <%--Style="margin-right: 5px;"--%>
     <td style="border:0px;width:25px;"><asp:LinkButton ID="SelectButton" runat="server" CommandName="View" Text="View"  CommandArgument='<%# Eval("ID") %>' /> </td>     
     <td style="border:0px;width:25px;"><%# Eval("ID") %>  </td>
     <td style="border:0px;width:400px;"><%# Eval("Company") %></td>
     <td style="border:0px;width:100px;"><%# Eval("ItemTotal") %> </td>
     <td style="border:0px;width:100px;"><%# Eval("BillDate","{0:dd/MM/yyyy}")  %> </td>
     <td style="border:0px;width:100px;"><%# Eval("CreatedByName") %> </td>
     <%--<td style="border:0px;width:100px;"><%# Eval("RequestedFor") %> </td>--%>
     <td style="border:0px;width:100px;"><%# Eval("AmendedByName") %></td>
     </tr>
     </table> 
     </asp:Panel>
        <br />
        <br />
     
     <asp:Panel ID="pnlBillingItem" runat="server" CssClass="LeftSide"  Width="100%"     >
    
     <asp:GridView ID="ItemsGridView" runat="server" DataSourceID="OIDODS" 
     AutoGenerateColumns="false"  SkinID="metro" OnRowCommand="ItemGridView_RowCommand" >
     <Columns >
     <%-- <asp:TemplateField>
        <ItemTemplate>
        <asp:Label ID="lblPopupMenu" runat="server"  ForeColor="Blue" Text="Action"></asp:Label>
         <asp:Panel ID="pnlPopupMenu" runat="server" CssClass="popupHover" Style="display: none">
        <div style="border: 1px outset white; padding: 2px;">
        <div>
            <asp:LinkButton ID="lnkBtnReceipt" runat="server" CommandArgument='<%#Eval("ID")%>' CommandName="Receipt" Text="Receipt" />
        </div>
        <div>
        <asp:LinkButton ID="lnkBtnDispatch" runat="server"  CommandArgument='<%#Eval("ID")%>' CommandName="Dispatch" Text="Dispatch" />
        </div>     
         </asp:Panel>   
        <ajax:HoverMenuExtender ID="hoverMenu" runat="server"
         PopDelay="300" PopupControlID="pnlPopupMenu"
        PopupPosition="Right" TargetControlID="lblPopupMenu" />
        </ItemTemplate>        
      </asp:TemplateField>  --%>
           
      <asp:TemplateField HeaderText="Item Code">
        <ItemTemplate>
        <%# Eval("Code") %>
        </ItemTemplate>
        </asp:TemplateField>
        
        <asp:TemplateField HeaderText="Description">
        <ItemTemplate>
        <%# Eval("Description") %>
        </ItemTemplate>
       </asp:TemplateField>
       
        <asp:TemplateField HeaderText="Quantity">
        <ItemTemplate>
        <%# Eval("Quantity") %>
        </ItemTemplate>
       </asp:TemplateField>
       
       <asp:TemplateField HeaderText="Balance">
        <ItemTemplate>
        <%# Eval("Balance")%>
        </ItemTemplate>
       </asp:TemplateField>
       
       <asp:TemplateField HeaderText="Amount">
        <ItemTemplate>
        <%# Eval("TotalAmount") %>
        </ItemTemplate>
       </asp:TemplateField>
     </Columns>
     </asp:GridView>
      
    </asp:Panel> 
     
  
      <asp:ObjectDataSource ID="OIDODS" runat="server" 
    TypeName="Billing.BusLogic.BillItem" ConflictDetection="CompareAllValues"
    SelectMethod="GetBillItems" DataObjectTypeName="Billing.Data.BillItemData" >
    <SelectParameters>   
    <asp:Parameter Name="BillID" Type="String" DefaultValue="" />
    </SelectParameters>    
    </asp:ObjectDataSource>         
     <ajax:CollapsiblePanelExtender ID="cpe" runat="Server"  
     TargetControlID="pnlBillingItem" CollapsedSize="0" Collapsed="True"  
     ExpandControlID="imgCollapsible"     CollapseControlID="imgCollapsible"
     AutoCollapse="false" AutoExpand="false" ScrollContents="true" 
     ImageControlID="imgCollapsible" ExpandedImage="~/Quotation/Images/iSUB.bmp" 
     CollapsedImage="~/Billing/Images/iADD.bmp" ExpandDirection="Vertical" />
      
    </ItemTemplate>
    </asp:TemplateField>
    </Columns>
    
</asp:GridView>
    </div>
     <asp:ObjectDataSource ID="ODODS" runat="server" 
    TypeName="Billing.BusLogic.Billing" ConflictDetection="CompareAllValues"
    SelectMethod="GetBills" DataObjectTypeName="Billing.Data.BillData" >
    <SelectParameters>   
    
     <asp:ControlParameter ControlID="txtSearch"     Name="searchText" Type="String" ConvertEmptyStringToNull="true" />    
    <asp:ControlParameter ControlID="txtID"         Name="Id" Type="String" ConvertEmptyStringToNull="true" />    
    <asp:ControlParameter ControlID="txtCreatedBy"  Name="CreatedBy" Type="String" ConvertEmptyStringToNull="true" />    
    <asp:ControlParameter ControlID="txtCompany"    Name="Company" Type="String" ConvertEmptyStringToNull="true" />    
    
    </SelectParameters>    
    </asp:ObjectDataSource>
   </asp:Content>

